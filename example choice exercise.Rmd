---
title: "Example choice set exercise"
author: "Meng Le Zhang and Lydia Warden"
date: "16/07/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tmap)
library(sf)

##  Hotfix latest sf has issues with tmap -- use this fix
## see:  https://github.com/mtennekes/tmap/issues/571
##  and solution to disable S2: https://github.com/mtennekes/tmap/issues/577

sf::sf_use_s2(FALSE)
tmap_mode('view')

```


```{r load-data-quietly, echo=FALSE}
RUCST_borders <-
  'cleaned data/rotherham borders example.rds' %>% readRDS

# Point around roth
ukgrid = "+init=epsg:27700"

RUCST <-
  st_point(
    c(442732, 392677)
  )

RUCST <-
  RUCST %>%
  st_sfc(
    crs = st_crs(ukgrid)
  )
RUCST <-
  RUCST %>% 
  st_buffer(2000)



```

# Example of exercise

This is example of a discrete choice experiments to test whether participants 'prefer' 
the maps produced by the Dean et al algorithm. 

First, we select a 2km radius around a set area that participants are familiar with. 
Then participants are shows a choice of two maps with borders in that area. Participants 
are asked to pick the map that best reflect community borders within that area. 

Then the exercise is repeated again with a different pair of maps for 4-5 times. 


## Example choice sets around Rotherham United Community Sports Trust (RUCST) 



### Choice-set 1

```{r choice1-quietly, echo=FALSE}

tm_shape(RUCST) + 
  tm_borders(
    lty = 'dotted',
    alpha = 0.5) +
  tm_shape(
    RUCST_borders %>% 
      filter(type %in% c('b', 'd'))
  ) +
  tm_lines(
    lwd = 3) +
  tm_facets('type', sync = T)


```

### Choice-set 2

```{r choice2-quietly, echo=FALSE}

tm_shape(RUCST) + 
  tm_borders(
    lty = 'dotted',
    alpha = 0.5) +
  tm_shape(
    RUCST_borders %>% 
      filter(type %in% c('a', 'c'))
  ) +
  tm_lines(
    lwd = 3) +
  tm_facets('type', sync = T)


```



### Choice-set 3

```{r choice3-quietly, echo=FALSE}

tm_shape(RUCST) + 
  tm_borders(
    lty = 'dotted',
    alpha = 0.5) +
  tm_shape(
    RUCST_borders %>% 
      filter(type %in% c('c', 'b'))
  ) +
  tm_lines(
    lwd = 3) +
  tm_facets('type', sync = T)


```





